# 3. Развертывание системы

Данная лабораторная работа направлена на освоение навыков контейнеризации, настройки CI/CD и настройки мониторинга для отслеживания состояния системы.

## Задание

### Контейнеризация сервисов

Для выполнения лабораторной работы необходимо провести **контейнеризацию** всех разработанных сервисов с использованием **Docker**. Также необходимо подготовить файл `docker-compose.yml` для их **совместного развертывания**.

::: tip Рекомендация
- Для эффективной работы с Docker используйте volumes для хранения данных, чтобы сохранять их между перезапусками контейнеров. 
- Для безопасного управления конфиденциальными данными используйте `.env` файлы, передавая переменные окружения в контейнеры.
:::

### Добавление мониторинга

Добавьте мониторинг для отслеживания состояния системы, для этого выполните следующие пункты:
- Установите и настройте **Prometheus** для сбора метрик со всех сервисов.
- Подключите **Grafana** для визуализации данных.
- Настройте следующие базовые алерты в Prometheus:
  - Использование процессора превышает 80%.
  - Объем оперативной памяти превышает 75%.
  - Сервисы недоступны более 30 секунд.

### Добавление автотестов

Реализуйте автоматическое тестирование системы, охватывающее ключевые аспекты работы приложения. Для этого напишите следующие виды тестирования:
- **Unit Tests**: Проверяйте отдельные модули или функции приложения, чтобы убедиться, что они работают корректно в изоляции.
- **Integration Tests**: Убедитесь, что различные компоненты системы взаимодействуют друг с другом без ошибок.


### Настройка CI/CD
Настройте CI/CD пайплайн в GitLab для автоматизированной сборки, тестирования и развертывания проекта на предоставленных серверах (или self-hosting) в соответствии со следующими этапами:

1. Этап сборки:
   - Сборка Docker-образов для всех сервисов.
2. Этап тестирования:
   - Запуск автотестов на собранных образах.
   - Генерация отчета о тестах.


::: important Важно
Убедитесь, что ваши CI/CD конфигурации безопасны. Скройте `secrets` (например, ключи и пароли) через переменные среды GitLab.
:::

## Критерии оценки

При оценке результатов лабораторной работы учитываются следующие аспекты проделанной работы:

1. Полнота и точность настройки системы мониторинга.
1. Полнота реализованных автотестов в пайплайне.
1. Умение аргументировать принятые решения при разработке `Dockerfile`, `docker-compose.yml`, `gitlab-ci.yml` и конфигураций мониторинга.  
1. Точность и полнота ответов на вопросы преподавателя по содержанию лабораторной работы при ее защите.