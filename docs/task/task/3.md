# 3. Развертывание системы

Данная лабораторная работа направлена на освоение навыков контейнеризации, настройки CI/CD и мониторинга для отслеживания состояния системы.

## Задание

### Контейнеризация сервисов

Для выполнения лабораторной работы необходимо провести **контейнеризацию** всех разработанных сервисов с использованием **Docker**. Также необходимо подготовить файл `docker-compose.yml` для их **совместного развертывания**.

::: tip Рекомендация
- Для передачи конфиденциальных данных в контейнеры используйте переменные окружения.
:::

### Добавление мониторинга

Добавьте мониторинг для отслеживания состояния системы, для этого выполните следующие пункты:
- Установите и настройте **Prometheus** для сбора метрик со всех сервисов.
- Подключите **Grafana** для визуализации данных.
- Настройте следующие базовые алерты в Prometheus:
  - Использование процессора превышает 80%.
  - Объем оперативной памяти превышает 75%.
  - Сервисы недоступны более 30 секунд.

### Добавление автотестов

Реализуйте автоматическое тестирование системы, охватывающее ключевые аспекты работы приложения. Для этого напишите следующие виды тестирования:

- **Unit Tests**: проверяйте отдельные модули или функции приложения, чтобы убедиться, что они работают корректно в изоляции.
- **Integration Tests**: убедитесь, что различные компоненты системы взаимодействуют друг с другом без ошибок.

### Настройка CI/CD

Настройте CI/CD пайплайн в `Forgejo` с использованием `Jenkins` для автоматизированной сборки и тестирования проекта на предоставленных серверах в соответствии со следующими этапами:

1. Этап сборки:
   - Сборка Docker-образов для всех сервисов.
2. Этап тестирования:
   - Запуск автотестов на собранных образах.
   - Генерация отчета о тестах.

::: important Важно
Убедитесь, что конфиденциальные данные (например, ключи и пароли) в CI/CD конфигурациях защищены. Используйте переменные окружения `Forgejo` и `Jenkins`.
:::

::: info Дополнительная информация 
Если вы хотите использовать альтернативный CI/CD пайплайн на self-hosting ресурсах, вы можете использовать GitLab CI/CD.
:::

## Критерии оценки

При оценке результатов лабораторной работы учитываются следующие аспекты проделанной работы:

1. Полнота и точность настройки системы мониторинга.
1. Полнота реализованных автотестов в пайплайне.
1. Умение аргументировать принятые решения при разработке `Dockerfile`, `docker-compose.yml`, `Jenkins` и конфигураций мониторинга.
1. Точность и полнота ответов на вопросы преподавателя по содержанию лабораторной работы при ее защите.
